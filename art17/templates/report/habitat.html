{% extends layout_template %}


{% block breadcrumbs %}
  {% from '_macros.html' import breadcrumbs %}
  {{ breadcrumbs(APP_BREADCRUMBS + [
      ('Habitat report', None),
    ]) }}
{% endblock %}


{% block content %}

  <h1>Habitat asssessments at Member State level</h1>

  <p>
    Choose a group and then a country. Optionally, further refine your query
    by selecting one of the available biogeographical regions for that
    country.
  </p>


  {% include 'report/filters.html' %}

    {% set colspan_all=22 if region else 23 %}
    {% if current_selection %}

    {% include 'common/note_report.html' %}
    {% include 'common/table_legend.html' %}

    <table class="complex_datatable">
      <caption>
      <b>Current selection</b>:
      {{ current_selection|join(', ') }}.
      {% if annexes %}
          <b>Annexes</b> {{ annexes|join(', ') }}.
      {% endif %}
      </caption>

      {% include 'common/habitat_table_header.html' with context %}

      <tbody class="stripe_3rd">
      {% for row in objects %}
        {% set visible = can_view(row, restricted_countries) %}
        {% set qa_errors = record_errors(row) %}
        <tr {% if row.is_assesm %}class="assesm"{% endif %}>
          <td class="border">
            {% set original_url=get_original_record_url(row) %}
            <a class="clipped popup-btn block" data-title="Factsheet" href="{{ original_url }}">
              {{ row.subject }} - {{ row.habitat.name }}
            </a>
          </td>

          {% if not country %}<td class="border">{{ row.eu_country_code }}</td>{% endif %}
          {% if not region %}<td class="border"><a href="#map">{{ row.region }}</a></td>{% endif %}

          {% if not visible %}
          <td class="border" colspan="4">
            {{ row.eu_country_code }} has provided a report to the European Commission under Article 17
          </td>
          {% else %}

            {% include 'summary/habitat/content/range.html' with context %}
            {% include 'summary/habitat/content/area.html' with context %}
            {% include 'summary/habitat/content/struct_func.html' with context %}
            {% include 'summary/habitat/content/future_prosp.html' with context %}
            {% include 'summary/common/content/overall_assessment.html' with context %}
            {% include 'summary/habitat/content/grided_maps.html' with context %}
            {% include 'summary/habitat/content/quality.html' with context %}
          {% endif %}
        </tr>
      {% endfor %}
      </tbody>

    </table>
    {% else %}
    <p><b>Please select a group.</b></p>
    {% endif %}
{% endblock %}
