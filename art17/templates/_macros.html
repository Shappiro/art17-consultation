{% macro parse_errors(fields, row, qa_errors, title='', classes='') %}
    {% set qtitle, qclasses = parse_qa_errors(fields, row, qa_errors) %}
    {% set letitle = (title or '') + ' ' + qtitle %}
    {% set letitle = letitle|trim %}
    {% if letitle -%}
    title="{{ letitle }}"
    {% endif %}
    class="{{ classes }} {{ qclasses }}"
{% endmacro %}

{% macro conclusion_td(color, content, colspan=1) %}
  {% set title=COUNTRY_ASSESSMENTS.get(content, '') %}
  <td class="{{ CONCLUSION_CLASSES.get(color, '') }} conclusion"
      {% if title %}title="{{ title }}"{% endif %} colspan="{{ colspan }}">
      <span>{{ content }}</span>
  </td>
{% endmacro %}

{% macro breadcrumbs(page_list) %}
  {%- for label, url in page_list %}
    {%- set cls = 'breadcrumbitemlast' if loop.last else 'breadcrumbitem' %}
    <div class="{{ cls }}">
      {%- if url %}
        <a href="{{ url }}">{{ label }}</a>
      {%- else %}
        {{ label }}
      {%- endif %}
    </div>
  {%- endfor %}
{%- endmacro %}

{% macro render_field_with_errors(field) %}
    {% set cls = 'form-error' if field.errors else '' %}
    {{ field.label }} {{ field(class=cls, **kwargs)|safe }}
    {% if field.errors %}
      {% for error in field.errors %}
        <p class="form-error-msg">{{ error }}</p>
      {% endfor %}
    {% endif %}
{% endmacro %}
